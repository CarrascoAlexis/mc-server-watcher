{
  "ipWhitelist": {
    "enabled": false,
    "allowedIPs": [
      "127.0.0.1",
      "::1"
    ],
    "allowedRanges": [
      "192.168.0.0/16",
      "10.0.0.0/8",
      "172.16.0.0/12"
    ]
  },
  "terminalRestrictions": {
    "minecraft-server": {
      "allowedCommands": [
        "cd *",
        "java *",
        "stop",
        "say *",
        "list",
        "whitelist *",
        "kick *",
        "save-all",
        "save-on",
        "save-off",
        "weather *",
        "time *",
        "gamemode * *"
      ],
      "deniedCommands": [
        "op *",
        "deop *"
      ],
      "requiresApproval": [
        "ban *",
        "pardon *",
        "give *"
      ],
      "maxCommandsPerMinute": 10
    },
    "backup-server": {
      "allowedCommands": [
        "cd *",
        "ls *",
        "pwd",
        "cat *",
        "less *",
        "tail *",
        "head *",
        "grep *",
        "find *",
        "du -h *",
        "df -h",
        "git status",
        "git log *",
        "git diff *",
        "git show *",
        "git branch *",
        "git remote *",
        "git pull",
        "git fetch *",
        "git add *",
        "git commit *",
        "git push *",
        "tar -czf *",
        "tar -xzf *",
        "zip *",
        "unzip *",
        "cp *",
        "mkdir *",
        "rsync *",
        "./backup.sh *",
        "./restore.sh *"
      ],
      "deniedCommands": [
        "rm -rf *",
        "git reset --hard *",
        "git clean -fd",
        "chmod -R *"
      ],
      "requiresApproval": [
        "rm *",
        "mv *",
        "git push origin main",
        "git push origin master",
        "chmod *"
      ],
      "maxCommandsPerMinute": 20
    },
    "web-app": {
      "allowedCommands": [
        "cd *",
        "ls *",
        "pwd",
        "cat *",
        "less *",
        "tail *",
        "head *",
        "grep *",
        "npm run *",
        "npm start",
        "npm test",
        "npm run dev",
        "npm run build",
        "node *",
        "pm2 status",
        "pm2 logs *",
        "pm2 restart *",
        "pm2 stop *",
        "pm2 list",
        "pm2 monit",
        "git status",
        "git pull",
        "git fetch",
        "git log *",
        "git diff *",
        "git branch",
        "git show *"
      ],
      "deniedCommands": [
        "npm install *",
        "npm uninstall *",
        "rm *",
        "git push *",
        "git reset *",
        "pm2 delete *"
      ],
      "requiresApproval": [
        "npm ci",
        "npm update",
        "pm2 restart all",
        "pm2 stop all"
      ],
      "maxCommandsPerMinute": 15
    }
  },
  "commandFiltering": {
    "enabled": true,
    "globalDeniedCommands": [
      "rm -rf *",
      "rm -rf /*",
      "mkfs *",
      "dd if=*",
      ":(){ :|:& };:",
      "chmod -R 777 /",
      "wget * | sh",
      "curl * | bash",
      "sudo rm *",
      "sudo dd *",
      "shutdown *",
      "reboot",
      "halt",
      "poweroff"
    ],
    "globalDeniedPatterns": [
      ".*\\bsudo\\s+rm\\b.*",
      ".*\\bsudo\\s+dd\\b.*",
      ".*>/dev/sd[a-z].*",
      ".*\\|\\s*sh.*",
      ".*\\|\\s*bash.*"
    ]
  },
  "rateLimiting": {
    "enabled": true,
    "globalLimit": 20,
    "perUserLimit": 10,
    "windowMs": 60000
  },
  "logging": {
    "enabled": true,
    "logAllCommands": true,
    "logFailedAttempts": true,
    "logPath": "./logs/security.log"
  }
}
